<mat-progress-bar mode="indeterminate" color="accent" *ngIf="loading" style="margin-bottom: 1em;"></mat-progress-bar>

<div *ngIf="journal != undefined" fxLayout="row wrap" style="margin: 1em;">
    <!-- ournal Information -->
    <mat-card fxFlex="1 2 calc(15em + 20px)" style="margin: .5em;">
        <mat-card-header>

            <!-- <img mat-card-avatar *ngIf="journal.data.logo; else logotemplate" [style.background-size]="'cover'" src="journal.data.logo">
            <ng-template #logotemplate>
                <img mat-card-avatar [src]="defaultLogo" alt="">
            </ng-template> -->

            <mat-card-title *ngIf="journal.name">
                <ng-container *ngIf="journal.source_type == 'SourceType.JOURNAL'">
                    Revista
                </ng-container>

                {{journal.name}}
            </mat-card-title>

            <mat-card-subtitle>
                <label *ngIf="journal.data.subtitle"> {{journal.data.subtitle}} </label>
                <label *ngIf="journal.data.shortname"> {{journal.data.shortname}} </label>
            </mat-card-subtitle>

        </mat-card-header>
        <mat-divider [inset]="true" style="margin-bottom: 1em; margin-top: 1em;"></mat-divider>
        <mat-card-content>

            <label *ngIf="journal.data.issn" style="font-weight: bold;">ISSN: </label>
            <div style="margin-left: .8em;">
                <p *ngIf="journal.data.issn.p">
                    <label>Impreso: </label> {{journal.data.issn.p}}
                </p>
                <p *ngIf="journal.data.issn.e">
                    <label>Electrónico</label> {{journal.data.issn.e}}
                </p>
                <p *ngIf="journal.data.issn.l">
                    <label>De enlace</label> {{journal.data.issn.l}}
                </p>
            </div>

            <p *ngIf="journal.data.rnps">
                <label style="font-weight: bold;"> RNPS: </label> {{journal.data.rnps}}
            </p>

            <p *ngIf="journal.data.url">
                <label style="font-weight: bold;"> URL: </label> {{journal.data.url}}
            </p>

            <p *ngIf="journal.data.email">
                <label style="font-weight: bold;"> Email: </label> {{journal.data.email}}
            </p>

            <p *ngIf="journal.data.seriadas_cubanas">
                <label style="font-weight: bold;"> Seriadas Cubanas: </label>
                <a href="journal.data.seriadas_cubanas">{{journal.data.seriadas_cubanas}}</a>
            </p>

            <p *ngIf="journal.data.purpose">
                <label style="font-weight: bold;"> Propósito: </label> {{journal.data.purpose}}
            </p>

            <p *ngIf="journal.data.start_year">
                <label style="font-weight: bold;"> Año de Inicio: </label> {{journal.data.start_year}}
            </p>

            <p *ngIf="journal.data.end_year">
                <label style="font-weight: bold;"> Año de Fin: </label> {{journal.data.end_year}}
            </p>

            <p *ngIf="journal.data.frequency">
                <label style="font-weight: bold;"> Frecuencia de Publicación: </label> {{journal.data.frequency}}
            </p>

            <div *ngIf="journal.data.description" class="e2e-inner-html-bound  text-align-justify"
                [innerHTML]="journal.data.description"></div>

        </mat-card-content>
        <mat-card-footer>
            <mat-divider [inset]="true" style="margin-bottom: 1em; margin-top: 1em;"></mat-divider>
            <ng-container *ngFor="let termSource of journal.terms">
                <p *ngIf="termSource.term.term.vocabulary_id == vocabularies.INTITUTION" style="padding-left: 1em;">
                    <mat-label style="font-weight: bold;"> Institución: </mat-label> {{ termSource.term.term.name }}
                </p>
            </ng-container>

            <ng-container *ngFor="let termSource of journal.terms">
                <p *ngIf="termSource.term.term.vocabulary_id == vocabularies.DB_GROUPS" style="padding-left: 1em;">
                    <mat-label style="font-weight: bold;"> Grupo: </mat-label> {{ termSource.term.term.name }}
                </p>
            </ng-container>

            <ng-container *ngFor="let termSource of journal.terms">
                <p *ngIf="termSource.term.term.vocabulary_id == vocabularies.PROVINCES" style="padding-left: 1em;">
                    <mat-label style="font-weight: bold;"> Provincia: </mat-label> {{ termSource.term.term.name }}
                </p>
            </ng-container>

            <ng-container *ngFor="let termSource of journal.terms">
                <p *ngIf="termSource.term.term.vocabulary_id == vocabularies.LICENCES" style="padding-left: 1em;">
                    <mat-label style="font-weight: bold;"> Licencia: </mat-label> {{ termSource.term.term.name }}
                </p>
            </ng-container>

            <mat-card style="margin: 1em; background-color: #e6e6e6ab;">
                <mat-card-header>
                    <mat-card-title> Materias:</mat-card-title>
                </mat-card-header>
                <mat-card-content>
                    <mat-chip-list aria-label="Materias" >
                        <ng-container *ngFor="let termSource of journal.terms">
                            <mat-chip *ngIf="termSource.term.term.vocabulary_id == vocabularies.SUBJECTS">{{ termSource.term.term.name }}</mat-chip>
                        </ng-container>
                      </mat-chip-list>
                </mat-card-content>
            </mat-card>

            <mat-card style="margin: 1em; background-color: #e6e6e6ab;">
                <mat-card-header>
                    <mat-card-title> Bases de Datos:</mat-card-title>
                </mat-card-header>
                <mat-card-content>
                    <mat-accordion>
                        <ng-container *ngFor="let termSource of journal.terms">
                            <mat-expansion-panel *ngIf="termSource.term.term.vocabulary_id == vocabularies.DATABASES"
                                (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                                <mat-expansion-panel-header>
                                    <mat-panel-title>
                                        {{ termSource.term.term.name }}
                                    </mat-panel-title>
                                    <mat-panel-description>

                                    </mat-panel-description>
                                </mat-expansion-panel-header>
                                <p *ngIf="termSource.data">{{ termSource.data.url }}</p>
                            </mat-expansion-panel>
                        </ng-container>
                    </mat-accordion>
                </mat-card-content>
            </mat-card>


        </mat-card-footer>
    </mat-card>

    <!-- proves if it has version to review -->
    <!-- <div *ngIf="!journal.version_to_review"> -->
    <mat-card
        *ngIf="!journal.version_to_review && journal.versions != undefined && journal.versions.length != 0 && journal.versions[0].data"
        fxFlex="1 2 calc(15em + 20px)" style="margin: .5em;">
        <mat-card-header>

            <!-- <img mat-card-avatar *ngIf="journal.versions[0].data.logo; else logotemplate" [style.background-size]="'cover'" src="journal.versions[0].data.logo">
            <ng-template #logotemplate>
                <img mat-card-avatar [src]="defaultLogo" alt="">
            </ng-template> -->

            <mat-card-title *ngIf="journal.versions[0].data.title">
                <ng-container *ngIf="journal.source_type == 'SourceType.JOURNAL'">
                    Revista
                </ng-container>
                {{journal.versions[0].data.title}}
            </mat-card-title>

            <mat-card-subtitle>
                <label *ngIf="journal.versions[0].data.subtitle"> {{journal.versions[0].data.subtitle}} </label>
                <label *ngIf="journal.versions[0].data.shortname"> {{journal.versions[0].data.shortname}} </label>
            </mat-card-subtitle>

        </mat-card-header>
        <mat-divider [inset]="true" style="margin-bottom: 1em; margin-top: 1em;"></mat-divider>

        <mat-card-content>

            <label style="font-weight: bold;">ISSN: </label>
            <div style="margin-left: .8em;">
                <p *ngIf="journal.versions[0].data.issn.p">
                    <label>Impreso: </label> {{journal.versions[0].data.issn.p}}
                </p>
                <p *ngIf="journal.versions[0].data.issn.e">
                    <label>Electrónico</label> {{journal.versions[0].data.issn.e}}
                </p>
                <p *ngIf="journal.versions[0].data.issn.l">
                    <label>De enlace</label> {{journal.versions[0].data.issn.l}}
                </p>
            </div>

            <p *ngIf="journal.versions[0].data.rnps">
                <label style="font-weight: bold;"> RNPS: </label> {{journal.versions[0].data.rnps}}
            </p>

            <p *ngIf="journal.versions[0].data.url">
                <label style="font-weight: bold;"> URL: </label> {{journal.versions[0].data.url}}
            </p>

            <p *ngIf="journal.versions[0].data.email">
                <label style="font-weight: bold;"> Email: </label> {{journal.versions[0].data.email}}
            </p>

            <p *ngIf="journal.versions[0].data.seriadas_cubanas">
                <label style="font-weight: bold;"> Seriadas Cubanas: </label>
                <a href="journal.versions[0].data.seriadas_cubanas">{{journal.versions[0].data.seriadas_cubanas}}</a>
            </p>

            <p *ngIf="journal.versions[0].data.purpose">
                <label style="font-weight: bold;"> Propósito: </label> {{journal.versions[0].data.purpose}}
            </p>

            <p *ngIf="journal.versions[0].data.start_year">
                <label style="font-weight: bold;"> Año de Inicio: </label> {{journal.versions[0].data.start_year}}
            </p>

            <p *ngIf="journal.versions[0].data.end_year">
                <label style="font-weight: bold;"> Año de Fin: </label> {{journal.versions[0].data.end_year}}
            </p>

            <p *ngIf="journal.versions[0].data.frequency">
                <label style="font-weight: bold;"> Frecuencia de Publicación: </label>
                {{journal.versions[0].data.frequency}}
            </p>

            <div *ngIf="journal.versions[0].data.description" class="e2e-inner-html-bound  text-align-justify"
                [innerHTML]="journal.versions[0].data.description"></div>

        </mat-card-content>

        <mat-card-footer>
            <mat-divider [inset]="true" style="margin-bottom: 1em; margin-top: 1em;"></mat-divider>
            <ng-container *ngFor="let termSource of journal.versions[0].terms">
                <p *ngIf="termSource.term.term.vocabulary_id == vocabularies.INTITUTION" style="padding-left: 1em;">
                    <mat-label style="font-weight: bold;"> Institución: </mat-label> {{ termSource.term.term.name }}
                </p>
            </ng-container>

            <ng-container *ngFor="let termSource of journal.versions[0].terms">
                <p *ngIf="termSource.term.term.vocabulary_id == vocabularies.DB_GROUPS" style="padding-left: 1em;">
                    <mat-label style="font-weight: bold;"> Grupo: </mat-label> {{ termSource.term.term.name }}
                </p>
            </ng-container>

            <ng-container *ngFor="let termSource of journal.versions[0].terms">
                <p *ngIf="termSource.term.term.vocabulary_id == vocabularies.PROVINCES" style="padding-left: 1em;">
                    <mat-label style="font-weight: bold;"> Provincia: </mat-label> {{ termSource.term.term.name }}
                </p>
            </ng-container>

            <ng-container *ngFor="let termSource of journal.versions[0].terms">
                <p *ngIf="termSource.term.term.vocabulary_id == vocabularies.LICENCES" style="padding-left: 1em;">
                    <mat-label style="font-weight: bold;"> Licencia: </mat-label> {{ termSource.term.term.name }}
                </p>
            </ng-container>

            <mat-card style="margin: 1em; background-color: #e6e6e6ab;">
                <mat-card-header>
                    <mat-card-title> Materias:</mat-card-title>
                </mat-card-header>
                <mat-card-content>
                    <mat-chip-list aria-label="Materias" >
                        <ng-container *ngFor="let termSource of journal.versions[0].terms">
                            <mat-chip *ngIf="termSource.term.term.vocabulary_id == vocabularies.SUBJECTS">{{ termSource.term.term.name }}</mat-chip>
                        </ng-container>
                      </mat-chip-list>
                </mat-card-content>
            </mat-card>

            <mat-card style="margin: 1em; background-color: #e6e6e6ab;">
                <mat-card-header>
                    <mat-card-title> Bases de Datos:</mat-card-title>
                </mat-card-header>
                <mat-card-content>
                    <mat-accordion>
                        <ng-container *ngFor="let termSource of journal.versions[0].terms">
                            <mat-expansion-panel *ngIf="termSource.term.term.vocabulary_id == vocabularies.DATABASES"
                                (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                                <mat-expansion-panel-header>
                                    <mat-panel-title>
                                        {{ termSource.term.term.name }}
                                    </mat-panel-title>
                                    <mat-panel-description>

                                    </mat-panel-description>
                                </mat-expansion-panel-header>
                                <p *ngIf="termSource.data">{{ termSource.data.url }}</p>
                            </mat-expansion-panel>
                        </ng-container>
                    </mat-accordion>
                </mat-card-content>
            </mat-card>


        </mat-card-footer>
    </mat-card>
    <!-- </div> -->


</div>

<mat-card *ngIf="journal == undefined" style="margin: 1em;">

    <mat-card-content>
        <h1>No se encontró la información solicitada</h1>
    </mat-card-content>

    <mat-card-actions>
        <a mat-stroked-button color="primary" [routerLink]="['/journal']">Volver a la lista</a>

    </mat-card-actions>

</mat-card>