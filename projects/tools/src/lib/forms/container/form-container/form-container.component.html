
<ng-container *ngIf="(panels)">
    <!-- *ngFor="let item of items"
        <toco-form-fields fields]="panel.content"></toco-form-fields> -->

<mat-accordion class="toco-form-container" *ngIf="(useAccordion)">

    <mat-expansion-panel *ngFor="let panel of panels; let newStep = index; let count = count"
        [expanded]="step == newStep" (opened)="setStep(newStep)" hideToggle>

        <mat-expansion-panel-header>
            <mat-panel-title>
                {{ panel.title }}
            </mat-panel-title>
            <mat-panel-description>
                {{ panel.description }}
                <mat-icon>{{ panel.iconName }}</mat-icon>
            </mat-panel-description>
        </mat-expansion-panel-header>

        <toco-form-fields [fields]="panel.content"></toco-form-fields>

        <mat-action-row>
            <button mat-button *ngIf="i > 0" color="warn" (click)="prevStep()">Anterior</button>
            <button mat-button *ngIf="i != l-1" color="primary" (click)="nextStep()">Siguente</button>
            
            <button *ngIf="i == l-1 && actionButtonIsStepperNext" mat-button matStepperNext color="primary" (click)="doAction()">{{actionLabel}}</button>

            <button *ngIf="i == l-1 && !actionButtonIsStepperNext" mat-button color="primary" (click)="doAction()">{{actionLabel}}</button>


        </mat-action-row>

    </mat-expansion-panel>

</mat-accordion>

<div *ngIf="(!useAccordion)" class="toco-form-container">
    <mat-card>
        <mat-card-content>
                <div *ngFor="let panel of panels">
                        <mat-card-header>
                            <mat-card-title>
                                {{ panel.title }}
                            </mat-card-title>
                            <mat-card-subtitle>
                                {{ panel.description }}
                                <mat-icon>{{ panel.iconName }}</mat-icon>
                            </mat-card-subtitle>
                        </mat-card-header>
                    
                        <mat-card-content>
                            <toco-form-fields [fields]="panel.content" ></toco-form-fields>
                        </mat-card-content>
                        <mat-divider></mat-divider>
                </div>
                
            <mat-card-actions fxLayout="row" fxLayoutAlign="end center">
                

                <button *ngIf="actionButtonIsStepperNext" mat-button matStepperNext color="primary" (click)="doAction()">{{actionLabel}}</button>

                <button *ngIf="!actionButtonIsStepperNext" mat-button color="primary" (click)="doAction()">{{actionLabel}}</button>

            </mat-card-actions>
        </mat-card-content>
    </mat-card>
</div>


</ng-container>